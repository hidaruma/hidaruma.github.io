language: bash
env:
  global:
  - GIT_AUTHOR_EMAIL=hidaurma@outlook.jp
  - GIT_AUTHOR_NAME=hidaruma
  - HUGO_VERSION=0.42.1
  - GIT_URL=https://${GIT_TOKEN}@github.com/hidaruma/hidaruma.github.io.git
  - secure: JnTdZRn8mivYQSNsbiiH9Qm/4AJ+jkTJGpzxVuIHCsF9CfJszYUNKzLUyx/5c5M5NqLqf4/6W8JEFzyCo/0mFa1hha9h9YMY4SXrhzZzLNLlHdox5SDpAB2pAIB92LfOcarjD57L7k7e/v08CEGJKpuP2tvqT/jQKfw6cEYWAd/J46zlKbZ5lcjd1b42wnbbaVZxd6Ad8AdL/ztiOCaN/AdA9u7OwkrEaPeeuroGQilbv0qadA7JGbv4LQrNOaSDFiDSRSNkkrZ6tjkGTWtHYQZj19x5YklwTECWbfCKQRUTbbH2gA6ETubfamZeSac5xUlLpEuHBHCDWp38T3cR2lM8k+EVEzaQOR/EuMa+E3Ne24mFO6x9mFvFOdM8j31Mapqpin3C8a2iOM1B4tYVQCtl4qQ8ndESd5sN5t7bxA6SbbYXkhaaVYJ7ocu8/l9F2COnprsV02+1bxL1AhMAB7WGWPBe0HaRPqQJ0b9QXRKOW6PZD5zq39G1/VSC0IRZo5fe1GT5ltKbFq2nL+hQ5tBc7oEBSP8ogT6q5ZC/zp+JX4NfDK4jYoTgQnZEctFG382K+UgMefn/eB7ipDJCiL86eH/jJv44zGZgzcIPFIa3CBKrzRDd0DoiRmFSeSFSa3IANfjjFCUEbvsCT8ypepPi7GTQSd6zW9wrdiYSmNk=

install:
  - wget https://github.com/gohugoio/hugo/release/download/v${HUGO_VERSION}/hugo_${HUGO_VERSION}_Linux-64bit.tar.gz
  - tar xzf hugo_${HUGO_VERSION}_Linux-64bit.tar.gz

before_deploy:
  - git remote set-url origin ${GIT_URL}
  - git fetch origin gh-pages:remotes/origin/gh-pages
  - git worktree add -B gh-pages public origin/gh-pages
  - "./hugo"

deploy:
  skip_cleanup: true
  provider: script
  script: scripts/deploy.sh
  on:
    branch: master
